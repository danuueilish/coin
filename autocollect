-- StarterPlayerScripts/AutoCollectTP.client.lua
-- GUI Toggle Auto Collect Coin + Teleport

local Players           = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService        = game:GetService("RunService")
local LocalPlayer       = Players.LocalPlayer

-- Folder coin sesuai penjelasan kamu
local coinsFolder = workspace:WaitForChild("PickupCoin")

-- RemoteFunction pickup resmi
local pickupRF = ReplicatedStorage:WaitForChild("RemoteFunctions"):WaitForChild("PickupCoin")

-- === GUI sederhana ===
local gui = Instance.new("ScreenGui")
gui.Name = "AutoCollectUI"
gui.ResetOnSpawn = false
gui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local btn = Instance.new("TextButton")
btn.Size = UDim2.fromOffset(170, 42)
btn.Position = UDim2.new(0, 20, 0, 70)
btn.TextScaled = true
btn.BackgroundColor3 = Color3.fromRGB(220, 130, 130)
btn.Text = "Auto Collect: OFF"
btn.Parent = gui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 8)
uiCorner.Parent = btn

local autoOn = false
local function updateBtn()
	btn.Text = autoOn and "Auto Collect: ON" or "Auto Collect: OFF"
	btn.BackgroundColor3 = autoOn and Color3.fromRGB(110, 220, 140) or Color3.fromRGB(220, 130, 130)
end
updateBtn()

btn.MouseButton1Click:Connect(function()
	autoOn = not autoOn
	updateBtn()
end)

-- === Loop teleport + collect ===
local INTERVAL = 0.4 -- delay antar coin (biar nggak terlalu spam)

RunService.Heartbeat:Connect(function(dt)
	if not autoOn then return end

	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	if not pickupRF then return end

	-- cari coin pertama yang masih ada
	for _, coin in ipairs(coinsFolder:GetChildren()) do
		if coin:IsA("Model") and coin:FindFirstChild("Root") then
			-- teleport player ke coin
			hrp.CFrame = coin.Root.CFrame + Vector3.new(0, 3, 0) -- sedikit di atas coin
			-- invoke server pickup
			pcall(function()
				pickupRF:InvokeServer(coin)
			end)
			task.wait(INTERVAL) -- tunggu sebelum pindah ke coin berikutnya
		end
	end
end)
